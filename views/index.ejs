<% title = "Forum" %>

<div class="forum-container">
  <% if (locals.user) { %>
    <div class="create-post">
      <h3>‚úèÔ∏è Create New Post</h3>
      <form method="POST" action="/create-post" class="post-form" enctype="multipart/form-data">
        <div class="form-group">
          <label for="subject">Subject:</label>
          <input type="text" id="subject" name="subject" required placeholder="Enter post subject...">
        </div>
        <div class="form-group">
          <label for="body">Body:</label>
          <textarea id="body" name="body" rows="6" required placeholder="Write your post content here..."></textarea>
        </div>
        <div class="form-group">
          <label for="image">Image (Optional):</label>
          <input type="file" id="image" name="image" accept="image/*" class="file-input">
          <small class="help-text">Max size: 5MB. Accepted formats: JPG, PNG, GIF, WebP</small>
        </div>
        <button type="submit" class="create-btn">üöÄ Create Post</button>
      </form>
    </div>
    <hr style="border-color: #444; margin: 20px 0;">
  <% } %>
  <% posts.forEach(post => { %>
    <div class="post">
      <div class="post-user">
        <img src="<%= post.avatar %>" alt="pfp">
        <div><strong><%= post.username %></strong></div>
        <div class="badges">
          <% post.badges.forEach(b => { %>
            <span class="badge <%= b %>"><%= b %></span>
          <% }) %>
        </div>
      </div>
      <div class="post-content">
        <h3><a href="/post/<%= post.id %>"><%= post.subject %></a></h3>
        <% if (post.image) { %>
          <div class="post-image">
            <img src="<%= post.image %>" alt="Post image" class="content-image">
          </div>
        <% } %>
        <p><%= post.body %></p>
        <small class="post-time">Posted on <%= new Date(post.time).toLocaleString() %></small>
      </div>
    </div>
  <% }) %>
</div>
